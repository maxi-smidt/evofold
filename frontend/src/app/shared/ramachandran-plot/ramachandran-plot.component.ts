import {Component, computed, input, InputSignal, Signal} from '@angular/core';
import {PlotlyModule} from 'angular-plotly.js';
import * as PlotlyJS from 'plotly.js-dist-min';
import {Data, Layout, Shape} from 'plotly.js-dist-min';
import {StoredSimulationData} from '../../types/StoredSimulationData';

PlotlyModule.plotlyjs = PlotlyJS;

@Component({
  selector: 'app-ramachandran-plot',
  imports: [
    PlotlyModule,
  ],
  template: `
    <plotly-plot [data]="data()" [layout]="layout"/>`,
})
export class RamachandranPlotComponent {
  private colorMap = ['white', 'red', 'brown', 'yellow']
  private coords: [number, number, number][] = [
    [-180,  180, 2], [-170,  180, 1], [-160,  180, 1], [-150,  180, 1], [-140,  180, 1], [-130,  180, 1], [-120,  180, 1], [-110,  180, 1], [-100,  180, 1], [-90,  180, 1], [-80,  180, 1], [-70,  180, 2], [-60,  180, 2], [-50,  180, 2], [-40,  180, 3], [-30,  180, 3], [-20,  180, 0], [-10,  180, 0], [10,  180, 0], [20,  180, 0], [30,  180, 0], [40,  180, 3], [50,  180, 3], [60,  180, 3], [70,  180, 3], [80,  180, 3], [90,  180, 0], [100,  180, 0], [110,  180, 0], [120,  180, 0], [130,  180, 0], [140,  180, 3], [150,  180, 3], [160,  180, 3], [170,  180, 3], [180,  180, 2],
    [-180,  170, 2], [-170,  170, 1], [-160,  170, 1], [-150,  170, 1], [-140,  170, 1], [-130,  170, 1], [-120,  170, 1], [-110,  170, 1], [-100,  170, 1], [-90,  170, 1], [-80,  170, 1], [-70,  170, 1], [-60,  170, 2], [-50,  170, 2], [-40,  170, 2], [-30,  170, 3], [-20,  170, 3], [-10,  170, 0], [10,  170, 0], [20,  170, 0], [30,  170, 0], [40,  170, 0], [50,  170, 0], [60,  170, 0], [70,  170, 0], [80,  170, 0], [90,  170, 0], [100,  170, 0], [110,  170, 0], [120,  170, 0], [130,  170, 0], [140,  170, 3], [150,  170, 3], [160,  170, 3], [170,  170, 2], [180,  170, 2],
    [-180,  160, 2], [-170,  160, 1], [-160,  160, 1], [-150,  160, 1], [-140,  160, 1], [-130,  160, 1], [-120,  160, 1], [-110,  160, 1], [-100,  160, 1], [-90,  160, 1], [-80,  160, 1], [-70,  160, 1], [-60,  160, 2], [-50,  160, 2], [-40,  160, 2], [-30,  160, 3], [-20,  160, 3], [-10,  160, 3], [10,  160, 3], [20,  160, 0], [30,  160, 0], [40,  160, 0], [50,  160, 0], [60,  160, 0], [70,  160, 0], [80,  160, 0], [90,  160, 0], [100,  160, 0], [110,  160, 0], [120,  160, 0], [130,  160, 0], [140,  160, 3], [150,  160, 3], [160,  160, 2], [170,  160, 2], [180,  160, 2],
    [-180,  150, 2], [-170,  150, 2], [-160,  150, 1], [-150,  150, 1], [-140,  150, 1], [-130,  150, 1], [-120,  150, 1], [-110,  150, 1], [-100,  150, 1], [-90,  150, 1], [-80,  150, 1], [-70,  150, 1], [-60,  150, 1], [-50,  150, 2], [-40,  150, 2], [-30,  150, 2], [-20,  150, 2], [-10,  150, 3], [10,  150, 3], [20,  150, 0], [30,  150, 0], [40,  150, 0], [50,  150, 0], [60,  150, 0], [70,  150, 0], [80,  150, 0], [90,  150, 0], [100,  150, 0], [110,  150, 0], [120,  150, 0], [130,  150, 0], [140,  150, 3], [150,  150, 3], [160,  150, 3], [170,  150, 2], [180,  150, 2],
    [-180,  140, 2], [-170,  140, 2], [-160,  140, 1], [-150,  140, 1], [-140,  140, 1], [-130,  140, 1], [-120,  140, 1], [-110,  140, 1], [-100,  140, 1], [-90,  140, 1], [-80,  140, 1], [-70,  140, 1], [-60,  140, 1], [-50,  140, 1], [-40,  140, 2], [-30,  140, 2], [-20,  140, 3], [-10,  140, 3], [10,  140, 3], [20,  140, 0], [30,  140, 0], [40,  140, 0], [50,  140, 0], [60,  140, 0], [70,  140, 0], [80,  140, 0], [90,  140, 0], [100,  140, 0], [110,  140, 0], [120,  140, 0], [130,  140, 0], [140,  140, 3], [150,  140, 3], [160,  140, 3], [170,  140, 3], [180,  140, 2],
    [-180,  130, 2], [-170,  130, 2], [-160,  130, 1], [-150,  130, 1], [-140,  130, 1], [-130,  130, 1], [-120,  130, 1], [-110,  130, 1], [-100,  130, 1], [-90,  130, 1], [-80,  130, 1], [-70,  130, 1], [-60,  130, 1], [-50,  130, 2], [-40,  130, 2], [-30,  130, 2], [-20,  130, 3], [-10,  130, 3], [10,  130, 3], [20,  130, 0], [30,  130, 0], [40,  130, 0], [50,  130, 0], [60,  130, 0], [70,  130, 0], [80,  130, 0], [90,  130, 0], [100,  130, 0], [110,  130, 0], [120,  130, 0], [130,  130, 0], [140,  130, 0], [150,  130, 3], [160,  130, 3], [170,  130, 3], [180,  130, 2],
    [-180,  120, 2], [-170,  120, 2], [-160,  120, 2], [-150,  120, 1], [-140,  120, 1], [-130,  120, 1], [-120,  120, 1], [-110,  120, 1], [-100,  120, 1], [-90,  120, 1], [-80,  120, 1], [-70,  120, 1], [-60,  120, 2], [-50,  120, 2], [-40,  120, 2], [-30,  120, 2], [-20,  120, 3], [-10,  120, 3], [10,  120, 3], [20,  120, 0], [30,  120, 0], [40,  120, 0], [50,  120, 3], [60,  120, 3], [70,  120, 3], [80,  120, 3], [90,  120, 3], [100,  120, 3], [110,  120, 0], [120,  120, 0], [130,  120, 0], [140,  120, 0], [150,  120, 0], [160,  120, 3], [170,  120, 3], [180,  120, 2],
    [-180,  110, 2], [-170,  110, 2], [-160,  110, 2], [-150,  110, 2], [-140,  110, 1], [-130,  110, 1], [-120,  110, 1], [-110,  110, 1], [-100,  110, 1], [-90,  110, 1], [-80,  110, 1], [-70,  110, 2], [-60,  110, 2], [-50,  110, 2], [-40,  110, 2], [-30,  110, 2], [-20,  110, 2], [-10,  110, 3], [10,  110, 3], [20,  110, 3], [30,  110, 3], [40,  110, 3], [50,  110, 3], [60,  110, 3], [70,  110, 3], [80,  110, 3], [90,  110, 3], [100,  110, 3], [110,  110, 0], [120,  110, 0], [130,  110, 0], [140,  110, 0], [150,  110, 0], [160,  110, 3], [170,  110, 3], [180,  110, 2],
    [-180,  100, 2], [-170,  100, 2], [-160,  100, 2], [-150,  100, 2], [-140,  100, 2], [-130,  100, 1], [-120,  100, 2], [-110,  100, 2], [-100,  100, 1], [-90,  100, 2], [-80,  100, 2], [-70,  100, 2], [-60,  100, 2], [-50,  100, 2], [-40,  100, 2], [-30,  100, 2], [-20,  100, 2], [-10,  100, 3], [10,  100, 3], [20,  100, 3], [30,  100, 3], [40,  100, 3], [50,  100, 3], [60,  100, 3], [70,  100, 2], [80,  100, 2], [90,  100, 3], [100,  100, 3], [110,  100, 0], [120,  100, 0], [130,  100, 0], [140,  100, 0], [150,  100, 0], [160,  100, 3], [170,  100, 3], [180,  100, 2],
    [-180,   90, 2], [-170,   90, 2], [-160,   90, 2], [-150,   90, 2], [-140,   90, 2], [-130,   90, 2], [-120,   90, 2], [-110,   90, 2], [-100,   90, 2], [-90,   90, 2], [-80,   90, 2], [-70,   90, 2], [-60,   90, 2], [-50,   90, 2], [-40,   90, 3], [-30,   90, 3], [-20,   90, 3], [-10,   90, 3], [10,   90, 3], [20,   90, 3], [30,   90, 3], [40,   90, 2], [50,   90, 2], [60,   90, 2], [70,   90, 2], [80,   90, 3], [90,   90, 3], [100,   90, 3], [110,   90, 0], [120,   90, 0], [130,   90, 0], [140,   90, 0], [150,   90, 0], [160,   90, 3], [170,   90, 3], [180,   90, 3],
    [-180,   80, 2], [-170,   80, 2], [-160,   80, 2], [-150,   80, 2], [-140,   80, 2], [-130,   80, 2], [-120,   80, 2], [-110,   80, 2], [-100,   80, 2], [-90,   80, 2], [-80,   80, 2], [-70,   80, 2], [-60,   80, 3], [-50,   80, 3], [-40,   80, 3], [-30,   80, 3], [-20,   80, 3], [-10,   80, 3], [10,   80, 3], [20,   80, 3], [30,   80, 3], [40,   80, 2], [50,   80, 2], [60,   80, 2], [70,   80, 2], [80,   80, 3], [90,   80, 3], [100,   80, 3], [110,   80, 0], [120,   80, 0], [130,   80, 0], [140,   80, 0], [150,   80, 0], [160,   80, 3], [170,   80, 3], [180,   80, 3],
    [-180,   70, 3], [-170,   70, 2], [-160,   70, 2], [-150,   70, 2], [-140,   70, 2], [-130,   70, 2], [-120,   70, 2], [-110,   70, 2], [-100,   70, 2], [-90,   70, 2], [-80,   70, 2], [-70,   70, 2], [-60,   70, 2], [-50,   70, 3], [-40,   70, 3], [-30,   70, 0], [-20,   70, 0], [-10,   70, 0], [10,   70, 0], [20,   70, 3], [30,   70, 3], [40,   70, 3], [50,   70, 2], [60,   70, 2], [70,   70, 2], [80,   70, 3], [90,   70, 3], [100,   70, 3], [110,   70, 3], [120,   70, 0], [130,   70, 0], [140,   70, 0], [150,   70, 0], [160,   70, 3], [170,   70, 3], [180,   70, 3],
    [-180,   60, 3], [-170,   60, 3], [-160,   60, 2], [-150,   60, 2], [-140,   60, 2], [-130,   60, 2], [-120,   60, 2], [-110,   60, 2], [-100,   60, 2], [-90,   60, 2], [-80,   60, 2], [-70,   60, 2], [-60,   60, 2], [-50,   60, 3], [-40,   60, 3], [-30,   60, 0], [-20,   60, 0], [-10,   60, 0], [10,   60, 0], [20,   60, 3], [30,   60, 3], [40,   60, 2], [50,   60, 2], [60,   60, 2], [70,   60, 2], [80,   60, 2], [90,   60, 2], [100,   60, 3], [110,   60, 3], [120,   60, 0], [130,   60, 0], [140,   60, 0], [150,   60, 0], [160,   60, 3], [170,   60, 3], [180,   60, 3],
    [-180,   50, 3], [-170,   50, 3], [-160,   50, 2], [-150,   50, 2], [-140,   50, 2], [-130,   50, 2], [-120,   50, 2], [-110,   50, 2], [-100,   50, 2], [-90,   50, 2], [-80,   50, 2], [-70,   50, 2], [-60,   50, 3], [-50,   50, 3], [-40,   50, 3], [-30,   50, 0], [-20,   50, 0], [-10,   50, 0], [10,   50, 0], [20,   50, 3], [30,   50, 3], [40,   50, 2], [50,   50, 2], [60,   50, 1], [70,   50, 2], [80,   50, 2], [90,   50, 3], [100,   50, 3], [110,   50, 3], [120,   50, 0], [130,   50, 0], [140,   50, 0], [150,   50, 0], [160,   50, 3], [170,   50, 3], [180,   50, 3],
    [-180,   40, 3], [-170,   40, 2], [-160,   40, 2], [-150,   40, 2], [-140,   40, 2], [-130,   40, 2], [-120,   40, 2], [-110,   40, 2], [-100,   40, 2], [-90,   40, 2], [-80,   40, 2], [-70,   40, 2], [-60,   40, 3], [-50,   40, 3], [-40,   40, 3], [-30,   40, 0], [-20,   40, 0], [-10,   40, 0], [10,   40, 0], [20,   40, 3], [30,   40, 3], [40,   40, 3], [50,   40, 2], [60,   40, 1], [70,   40, 1], [80,   40, 2], [90,   40, 3], [100,   40, 3], [110,   40, 3], [120,   40, 0], [130,   40, 0], [140,   40, 0], [150,   40, 0], [160,   40, 3], [170,   40, 3], [180,   40, 3],
    [-180,   30, 3], [-170,   30, 2], [-160,   30, 2], [-150,   30, 2], [-140,   30, 2], [-130,   30, 2], [-120,   30, 2], [-110,   30, 1], [-100,   30, 2], [-90,   30, 2], [-80,   30, 2], [-70,   30, 2], [-60,   30, 2], [-50,   30, 3], [-40,   30, 3], [-30,   30, 3], [-20,   30, 0], [-10,   30, 0], [10,   30, 0], [20,   30, 3], [30,   30, 3], [40,   30, 3], [50,   30, 2], [60,   30, 2], [70,   30, 2], [80,   30, 2], [90,   30, 2], [100,   30, 3], [110,   30, 3], [120,   30, 0], [130,   30, 0], [140,   30, 0], [150,   30, 0], [160,   30, 3], [170,   30, 3], [180,   30, 3],
    [-180,   20, 3], [-170,   20, 2], [-160,   20, 2], [-150,   20, 2], [-140,   20, 2], [-130,   20, 2], [-120,   20, 1], [-110,   20, 1], [-100,   20, 1], [-90,   20, 1], [-80,   20, 2], [-70,   20, 2], [-60,   20, 2], [-50,   20, 3], [-40,   20, 3], [-30,   20, 3], [-20,   20, 3], [-10,   20, 0], [10,   20, 0], [20,   20, 0], [30,   20, 3], [40,   20, 3], [50,   20, 3], [60,   20, 2], [70,   20, 2], [80,   20, 2], [90,   20, 3], [100,   20, 3], [110,   20, 3], [120,   20, 0], [130,   20, 0], [140,   20, 0], [150,   20, 0], [160,   20, 3], [170,   20, 3], [180,   20, 3],
    [-180,   10, 3], [-170,   10, 2], [-160,   10, 2], [-150,   10, 2], [-140,   10, 2], [-130,   10, 2], [-120,   10, 1], [-110,   10, 1], [-100,   10, 1], [-90,   10, 1], [-80,   10, 1], [-70,   10, 2], [-60,   10, 2], [-50,   10, 2], [-40,   10, 3], [-30,   10, 3], [-20,   10, 3], [-10,   10, 0], [10,   10, 0], [20,   10, 0], [30,   10, 3], [40,   10, 3], [50,   10, 3], [60,   10, 3], [70,   10, 2], [80,   10, 2], [90,   10, 2], [100,   10, 3], [110,   10, 3], [120,   10, 0], [130,   10, 0], [140,   10, 0], [150,   10, 0], [160,   10, 3], [170,   10, 3], [180,   10, 3],
    [-180,  -10, 3], [-170,  -10, 2], [-160,  -10, 2], [-150,  -10, 2], [-140,  -10, 2], [-130,  -10, 1], [-120,  -10, 1], [-110,  -10, 1], [-100,  -10, 1], [-90,  -10, 1], [-80,  -10, 1], [-70,  -10, 1], [-60,  -10, 2], [-50,  -10, 2], [-40,  -10, 2], [-30,  -10, 3], [-20,  -10, 3], [-10,  -10, 3], [10,  -10, 0], [20,  -10, 0], [30,  -10, 3], [40,  -10, 3], [50,  -10, 3], [60,  -10, 2], [70,  -10, 3], [80,  -10, 2], [90,  -10, 2], [100,  -10, 3], [110,  -10, 3], [120,  -10, 0], [130,  -10, 0], [140,  -10, 0], [150,  -10, 0], [160,  -10, 3], [170,  -10, 3], [180,  -10, 3],
    [-180,  -20, 3], [-170,  -20, 2], [-160,  -20, 2], [-150,  -20, 2], [-140,  -20, 2], [-130,  -20, 2], [-120,  -20, 1], [-110,  -20, 1], [-100,  -20, 1], [-90,  -20, 1], [-80,  -20, 1], [-70,  -20, 1], [-60,  -20, 1], [-50,  -20, 2], [-40,  -20, 2], [-30,  -20, 3], [-20,  -20, 3], [-10,  -20, 3], [10,  -20, 3], [20,  -20, 0], [30,  -20, 3], [40,  -20, 3], [50,  -20, 3], [60,  -20, 3], [70,  -20, 3], [80,  -20, 3], [90,  -20, 3], [100,  -20, 3], [110,  -20, 3], [120,  -20, 0], [130,  -20, 0], [140,  -20, 0], [150,  -20, 0], [160,  -20, 3], [170,  -20, 3], [180,  -20, 3],
    [-180,  -30, 3], [-170,  -30, 3], [-160,  -30, 2], [-150,  -30, 2], [-140,  -30, 2], [-130,  -30, 2], [-120,  -30, 1], [-110,  -30, 1], [-100,  -30, 1], [-90,  -30, 1], [-80,  -30, 1], [-70,  -30, 1], [-60,  -30, 1], [-50,  -30, 1], [-40,  -30, 2], [-30,  -30, 2], [-20,  -30, 3], [-10,  -30, 3], [10,  -30, 3], [20,  -30, 0], [30,  -30, 3], [40,  -30, 3], [50,  -30, 3], [60,  -30, 3], [70,  -30, 3], [80,  -30, 3], [90,  -30, 3], [100,  -30, 3], [110,  -30, 3], [120,  -30, 0], [130,  -30, 0], [140,  -30, 0], [150,  -30, 0], [160,  -30, 3], [170,  -30, 3], [180,  -30, 3],
    [-180,  -40, 3], [-170,  -40, 3], [-160,  -40, 2], [-150,  -40, 2], [-140,  -40, 2], [-130,  -40, 2], [-120,  -40, 2], [-110,  -40, 1], [-100,  -40, 1], [-90,  -40, 1], [-80,  -40, 1], [-70,  -40, 1], [-60,  -40, 1], [-50,  -40, 1], [-40,  -40, 2], [-30,  -40, 2], [-20,  -40, 2], [-10,  -40, 3], [10,  -40, 3], [20,  -40, 3], [30,  -40, 0], [40,  -40, 0], [50,  -40, 0], [60,  -40, 0], [70,  -40, 0], [80,  -40, 0], [90,  -40, 0], [100,  -40, 0], [110,  -40, 0], [120,  -40, 0], [130,  -40, 0], [140,  -40, 0], [150,  -40, 0], [160,  -40, 3], [170,  -40, 3], [180,  -40, 3],
    [-180,  -50, 3], [-170,  -50, 3], [-160,  -50, 3], [-150,  -50, 2], [-140,  -50, 2], [-130,  -50, 2], [-120,  -50, 2], [-110,  -50, 2], [-100,  -50, 1], [-90,  -50, 1], [-80,  -50, 1], [-70,  -50, 1], [-60,  -50, 1], [-50,  -50, 1], [-40,  -50, 1], [-30,  -50, 2], [-20,  -50, 2], [-10,  -50, 3], [10,  -50, 3], [20,  -50, 3], [30,  -50, 0], [40,  -50, 0], [50,  -50, 0], [60,  -50, 0], [70,  -50, 0], [80,  -50, 0], [90,  -50, 0], [100,  -50, 0], [110,  -50, 0], [120,  -50, 0], [130,  -50, 0], [140,  -50, 0], [150,  -50, 0], [160,  -50, 3], [170,  -50, 3], [180,  -50, 3],
    [-180,  -60, 3], [-170,  -60, 2], [-160,  -60, 2], [-150,  -60, 2], [-140,  -60, 2], [-130,  -60, 2], [-120,  -60, 2], [-110,  -60, 2], [-100,  -60, 2], [-90,  -60, 1], [-80,  -60, 1], [-70,  -60, 1], [-60,  -60, 1], [-50,  -60, 1], [-40,  -60, 1], [-30,  -60, 2], [-20,  -60, 2], [-10,  -60, 2], [10,  -60, 3], [20,  -60, 3], [30,  -60, 3], [40,  -60, 0], [50,  -60, 0], [60,  -60, 0], [70,  -60, 0], [80,  -60, 0], [90,  -60, 0], [100,  -60, 0], [110,  -60, 0], [120,  -60, 0], [130,  -60, 0], [140,  -60, 0], [150,  -60, 0], [160,  -60, 3], [170,  -60, 3], [180,  -60, 3],
    [-180,  -70, 2], [-170,  -70, 2], [-160,  -70, 3], [-150,  -70, 2], [-140,  -70, 2], [-130,  -70, 2], [-120,  -70, 2], [-110,  -70, 2], [-100,  -70, 2], [-90,  -70, 2], [-80,  -70, 2], [-70,  -70, 1], [-60,  -70, 1], [-50,  -70, 1], [-40,  -70, 1], [-30,  -70, 2], [-20,  -70, 2], [-10,  -70, 2], [10,  -70, 3], [20,  -70, 3], [30,  -70, 3], [40,  -70, 0], [50,  -70, 0], [60,  -70, 0], [70,  -70, 0], [80,  -70, 0], [90,  -70, 0], [100,  -70, 0], [110,  -70, 0], [120,  -70, 0], [130,  -70, 0], [140,  -70, 0], [150,  -70, 0], [160,  -70, 3], [170,  -70, 3], [180,  -70, 3],
    [-180,  -80, 3], [-170,  -80, 3], [-160,  -80, 3], [-150,  -80, 2], [-140,  -80, 2], [-130,  -80, 2], [-120,  -80, 2], [-110,  -80, 2], [-100,  -80, 2], [-90,  -80, 2], [-80,  -80, 2], [-70,  -80, 2], [-60,  -80, 2], [-50,  -80, 2], [-40,  -80, 2], [-30,  -80, 2], [-20,  -80, 2], [-10,  -80, 2], [10,  -80, 2], [20,  -80, 3], [30,  -80, 3], [40,  -80, 0], [50,  -80, 0], [60,  -80, 0], [70,  -80, 0], [80,  -80, 0], [90,  -80, 0], [100,  -80, 0], [110,  -80, 0], [120,  -80, 0], [130,  -80, 0], [140,  -80, 0], [150,  -80, 0], [160,  -80, 3], [170,  -80, 3], [180,  -80, 3],
    [-180,  -90, 3], [-170,  -90, 3], [-160,  -90, 3], [-150,  -90, 3], [-140,  -90, 3], [-130,  -90, 2], [-120,  -90, 2], [-110,  -90, 2], [-100,  -90, 2], [-90,  -90, 2], [-80,  -90, 2], [-70,  -90, 2], [-60,  -90, 2], [-50,  -90, 2], [-40,  -90, 2], [-30,  -90, 2], [-20,  -90, 2], [-10,  -90, 2], [10,  -90, 3], [20,  -90, 3], [30,  -90, 3], [40,  -90, 0], [50,  -90, 0], [60,  -90, 0], [70,  -90, 0], [80,  -90, 0], [90,  -90, 0], [100,  -90, 0], [110,  -90, 0], [120,  -90, 0], [130,  -90, 0], [140,  -90, 0], [150,  -90, 0], [160,  -90, 3], [170,  -90, 3], [180,  -90, 3],
    [-180, -100, 0], [-170, -100, 3], [-160, -100, 3], [-150, -100, 3], [-140, -100, 3], [-130, -100, 2], [-120, -100, 2], [-110, -100, 2], [-100, -100, 2], [-90, -100, 2], [-80, -100, 2], [-70, -100, 2], [-60, -100, 2], [-50, -100, 2], [-40, -100, 2], [-30, -100, 3], [-20, -100, 3], [-10, -100, 3], [10, -100, 3], [20, -100, 3], [30, -100, 3], [40, -100, 0], [50, -100, 0], [60, -100, 0], [70, -100, 0], [80, -100, 0], [90, -100, 0], [100, -100, 0], [110, -100, 0], [120, -100, 0], [130, -100, 0], [140, -100, 0], [150, -100, 0], [160, -100, 0], [170, -100, 0], [180, -100, 0],
    [-180, -110, 0], [-170, -110, 0], [-160, -110, 0], [-150, -110, 3], [-140, -110, 3], [-130, -110, 3], [-120, -110, 3], [-110, -110, 3], [-100, -110, 3], [-90, -110, 3], [-80, -110, 3], [-70, -110, 2], [-60, -110, 3], [-50, -110, 3], [-40, -110, 3], [-30, -110, 3], [-20, -110, 3], [-10, -110, 3], [10, -110, 3], [20, -110, 3], [30, -110, 0], [40, -110, 0], [50, -110, 0], [60, -110, 0], [70, -110, 0], [80, -110, 0], [90, -110, 0], [100, -110, 0], [110, -110, 0], [120, -110, 0], [130, -110, 0], [140, -110, 0], [150, -110, 0], [160, -110, 0], [170, -110, 0], [180, -110, 0],
    [-180, -120, 0], [-170, -120, 0], [-160, -120, 0], [-150, -120, 3], [-140, -120, 3], [-130, -120, 3], [-120, -120, 3], [-110, -120, 2], [-100, -120, 2], [-90, -120, 3], [-80, -120, 3], [-70, -120, 3], [-60, -120, 3], [-50, -120, 3], [-40, -120, 3], [-30, -120, 3], [-20, -120, 3], [-10, -120, 0], [10, -120, 0], [20, -120, 0], [30, -120, 0], [40, -120, 0], [50, -120, 0], [60, -120, 0], [70, -120, 0], [80, -120, 0], [90, -120, 0], [100, -120, 0], [110, -120, 0], [120, -120, 0], [130, -120, 0], [140, -120, 0], [150, -120, 0], [160, -120, 0], [170, -120, 0], [180, -120, 0],
    [-180, -130, 3], [-170, -130, 3], [-160, -130, 3], [-150, -130, 3], [-140, -130, 3], [-130, -130, 2], [-120, -130, 2], [-110, -130, 3], [-100, -130, 3], [-90, -130, 3], [-80, -130, 3], [-70, -130, 3], [-60, -130, 3], [-50, -130, 3], [-40, -130, 0], [-30, -130, 0], [-20, -130, 0], [-10, -130, 0], [10, -130, 0], [20, -130, 0], [30, -130, 0], [40, -130, 3], [50, -130, 3], [60, -130, 3], [70, -130, 3], [80, -130, 3], [90, -130, 0], [100, -130, 0], [110, -130, 0], [120, -130, 0], [130, -130, 0], [140, -130, 0], [150, -130, 0], [160, -130, 0], [170, -130, 0], [180, -130, 0],
    [-180, -140, 3], [-170, -140, 3], [-160, -140, 3], [-150, -140, 3], [-140, -140, 3], [-130, -140, 3], [-120, -140, 2], [-110, -140, 2], [-100, -140, 2], [-90, -140, 2], [-80, -140, 3], [-70, -140, 3], [-60, -140, 3], [-50, -140, 3], [-40, -140, 0], [-30, -140, 0], [-20, -140, 0], [-10, -140, 0], [10, -140, 0], [20, -140, 0], [30, -140, 0], [40, -140, 3], [50, -140, 3], [60, -140, 3], [70, -140, 3], [80, -140, 3], [90, -140, 0], [100, -140, 0], [110, -140, 0], [120, -140, 0], [130, -140, 0], [140, -140, 0], [150, -140, 0], [160, -140, 0], [170, -140, 0], [180, -140, 0],
    [-180, -150, 3], [-170, -150, 2], [-160, -150, 2], [-150, -150, 2], [-140, -150, 3], [-130, -150, 2], [-120, -150, 2], [-110, -150, 2], [-100, -150, 2], [-90, -150, 2], [-80, -150, 3], [-70, -150, 3], [-60, -150, 3], [-50, -150, 3], [-40, -150, 3], [-30, -150, 0], [-20, -150, 0], [-10, -150, 0], [10, -150, 0], [20, -150, 0], [30, -150, 0], [40, -150, 3], [50, -150, 3], [60, -150, 2], [70, -150, 3], [80, -150, 3], [90, -150, 3], [100, -150, 0], [110, -150, 0], [120, -150, 0], [130, -150, 0], [140, -150, 0], [150, -150, 0], [160, -150, 0], [170, -150, 0], [180, -150, 0],
    [-180, -160, 3], [-170, -160, 2], [-160, -160, 2], [-150, -160, 2], [-140, -160, 2], [-130, -160, 2], [-120, -160, 2], [-110, -160, 2], [-100, -160, 2], [-90, -160, 2], [-80, -160, 2], [-70, -160, 3], [-60, -160, 3], [-50, -160, 3], [-40, -160, 3], [-30, -160, 0], [-20, -160, 0], [-10, -160, 0], [10, -160, 0], [20, -160, 0], [30, -160, 0], [40, -160, 3], [50, -160, 3], [60, -160, 2], [70, -160, 3], [80, -160, 3], [90, -160, 3], [100, -160, 0], [110, -160, 0], [120, -160, 0], [130, -160, 0], [140, -160, 0], [150, -160, 0], [160, -160, 3], [170, -160, 3], [180, -160, 3],
    [-180, -170, 3], [-170, -170, 2], [-160, -170, 2], [-150, -170, 2], [-140, -170, 2], [-130, -170, 2], [-120, -170, 2], [-110, -170, 2], [-100, -170, 2], [-90, -170, 2], [-80, -170, 2], [-70, -170, 2], [-60, -170, 2], [-50, -170, 3], [-40, -170, 3], [-30, -170, 0], [-20, -170, 0], [-10, -170, 0], [10, -170, 0], [20, -170, 0], [30, -170, 0], [40, -170, 3], [50, -170, 3], [60, -170, 2], [70, -170, 2], [80, -170, 3], [90, -170, 3], [100, -170, 0], [110, -170, 0], [120, -170, 0], [130, -170, 0], [140, -170, 0], [150, -170, 0], [160, -170, 3], [170, -170, 3], [180, -170, 3],
    [-180, -180, 2], [-170, -180, 2], [-160, -180, 2], [-150, -180, 2], [-140, -180, 2], [-130, -180, 2], [-120, -180, 2], [-110, -180, 2], [-100, -180, 2], [-90, -180, 2], [-80, -180, 2], [-70, -180, 2], [-60, -180, 2], [-50, -180, 3], [-40, -180, 3], [-30, -180, 0], [-20, -180, 0], [-10, -180, 0], [10, -180, 0], [20, -180, 0], [30, -180, 0], [40, -180, 3], [50, -180, 3], [60, -180, 3], [70, -180, 3], [80, -180, 3], [90, -180, 3], [100, -180, 0], [110, -180, 0], [120, -180, 0], [130, -180, 0], [140, -180, 0], [150, -180, 0], [160, -180, 3], [170, -180, 3], [180, -180, 2],
  ];

  protected layout: Partial<Layout> = {
    autosize: false,
    xaxis: {
      range: [-180, 180],
      dtick: 60,
      zeroline: false,
      fixedrange: true,
      showline: true,
      title: {
        text: 'ф (phi) [°]'
      }
    },
    yaxis: {
      range: [-180, 180],
      dtick: 60,
      zeroline: false,
      fixedrange: true,
      linecolor: 'black',
      title: {
        text: 'Ψ (psi) [°]'
      }
    },
    height: 600,
    width: 650,
    modebar: {
      remove: ['select2d', 'lasso2d']
    },
    margin: {
      t: 40,
      r: 10,
      b: 40,
      l: 40
    },
    shapes: this.makeFavorShapes()
  }
  public simulationData: InputSignal<[string, StoredSimulationData][]> = input.required();
  public sequence: InputSignal<string> = input.required();
  protected data: Signal<Data[]> = computed(() => {
    return this.simulationData().map(d => {
      return {
        x: d[1].angles.map(angle => angle[0]).slice(1, -1),
        y: d[1].angles.map(angle => angle[1]).slice(1, -1),
        hovertemplate: '<b>%{text}</b><br>ф: %{x:.2f}°<br>Ψ: %{y:.2f}°<extra></extra>',
        text: this.sequence().split('').map((sequence, i) => `Pos ${i + 1} (${sequence})`).slice(1, -1),
        type: 'scatter',
        mode: 'markers',
        name: `Gen. ${d[1].generation}`
      }
    });
  });

  private makeFavorShapes(): Partial<Shape>[] {
    return this.coords.map(coord => this.makeShape(coord[0], coord[1], coord[2]));
  }

  private makeShape(x: number, y: number, colorIdx: number): Partial<Shape> {
    return {
      type: 'rect',
      x0: x,
      x1: x >= 0 ? x - 10 : x + 10,
      y0: y,
      y1: y >= 0 ? y - 10 : y + 10,
      opacity: 0.1,
      fillcolor: this.colorMap[colorIdx],
      line: {
        width: 0
      }
    }
  }
}
